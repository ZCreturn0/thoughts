<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>水波效果</title>
        <style>
            .wave {
                width: 30px;
                height: 30px;
                border-radius: 50%;
                position: absolute;
                border: 1px solid red;
                top: calc(50% - 15px);
                left: calc(50% - 15px);
                background: url('./bg.jpg') no-repeat;
                /* background-attachment: fixed; */
                background-position: center center;
                transition: all .5s;
            }

            /* @keyframes expand {
                0% {
                    width: 30px;
                    height: 30px;
                    top: calc((100% - 30px) / 2);
                    left: calc((100% - 30px) / 2);
                }

                100% {
                    width: 300px;
                    height: 300px;
                    top: calc((100% - 300px) / 2);
                    left: calc((100% - 300px) / 2);
                }
            } */

            .wave0 {
                z-index: 2;
                /* animation: expand .5s forwards; */
                /* background-size: auto 470px; */
                background-size: 100% 100%;
            }

            .wave1 {
                z-index: 3;
                /* animation: expand .5s 0.2s forwards; */
                /* background-size: auto 440px; */
                background-size: 100% 100%;
            }

            .wave2 {
                z-index: 4;
                /* animation: expand .5s 0.4s forwards; */
                /* background-size: auto 460px; */
                background-size: 100% 100%;
            }

            .wave3 {
                z-index: 5;
                /* animation: expand .5s 0.6s forwards; */
                /* background-size: auto 430px; */
                background-size: 100% 100%;
            }

            .wave4 {
                z-index: 6;
                /* animation: expand .5s 0.8s forwards; */
                /* background-size: auto 440px; */
                background-size: 100% 100%;
            }

            .wave5 {
                z-index: 7;
                /* animation: expand .5s 1.0s forwards; */
                /* background-size: auto 411px; */
                background-size: 100% 100%;
            }
            #pic{
                position: relative;
                width: 658px;
                height: 411px;
                background-image: url('./bg.jpg');
                margin: 0 auto;
                overflow: hidden;
            }
            #test{
                border: 1px solid red;
                width: 100px;
                height: 100px;
                top: 85px;
                left: 85px;
                border-radius: 50%;
                background-size: 658px 411px;
                background-image: url('./bg.jpg');
                background-position: -85px -85px;
                position: absolute;
            }
        </style>
    </head>
    <body>
        <div id="pic">
            <!-- <div id="test"></div> -->
            <!-- <div class="wave wave5"></div>
            <div class="wave wave4"></div>
            <div class="wave wave3"></div>
            <div class="wave wave2"></div>
            <div class="wave wave1"></div>
            <div class="wave wave0"></div> -->
        </div>
        <script>
            var pic = document.getElementById('pic');
            var index = 100;
            function setPosition(el, x, y){
                el.style.left = x + 'px';
                el.style.top = y + 'px';
                el.style.zIndex = index++;
            }
            function init(el){
                el.style.width = '30px';
                el.style.height = '30px';
                el.style.left = parseInt(el.style.left) - 15 + 'px';
                el.style.top = parseInt(el.style.top) - 15 + 'px';
                // el.style.backgroundPosition = `${el.style.left} ${el.style.top}`;
            }
            function expand(el){
                el.style.width = '300px';
                el.style.height = '300px';
                el.style.left = parseInt(el.style.left) - 150 + 'px';
                el.style.top = parseInt(el.style.top) - 150 + 'px';
            }
            function wave(x, y, z){
                var wave0 = document.createElement('div');
                wave0.classList = 'wave wave0';
                setPosition(wave0, x, y);
                var wave1 = document.createElement('div');
                wave1.classList = 'wave wave1';
                setPosition(wave1, x, y);
                var wave2 = document.createElement('div');
                wave2.classList = 'wave wave2';
                setPosition(wave2, x, y);
                var wave3 = document.createElement('div');
                wave3.classList = 'wave wave3';
                setPosition(wave3, x, y);
                var wave4 = document.createElement('div');
                wave4.classList = 'wave wave4';
                setPosition(wave4, x, y);
                var wave5 = document.createElement('div');
                wave5.classList = 'wave wave5';
                setPosition(wave5, x, y);
                pic.appendChild(wave0);
                // pic.appendChild(wave1);
                // pic.appendChild(wave2);
                // pic.appendChild(wave3);
                // pic.appendChild(wave4);
                // pic.appendChild(wave5);
                setTimeout(() => {
                    init(wave0);
                    expand(wave0);
                }, 0);
                setTimeout(() => {
                    init(wave1);
                    expand(wave1);
                }, 200);
                setTimeout(() => {
                    init(wave2);
                    expand(wave2);
                }, 400);
                setTimeout(() => {
                    init(wave3);
                    expand(wave3);
                }, 600);
                setTimeout(() => {
                    init(wave4);
                    expand(wave4);
                }, 800);
                setTimeout(() => {
                    init(wave5);
                    expand(wave5);
                }, 1000);
            }
            pic.addEventListener('click', function(e){
                console.log(e.offsetX, e.offsetY);
                wave(e.offsetX, e.offsetY, index++);
            }, false);
        </script>
    </body>
</html>